@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom, 1rem);
  }

  /* Improve dialog scrolling on mobile */
  .dialog-mobile-scroll {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* Handle mobile keyboard viewport */
  @supports (height: 100dvh) {
    .dialog-mobile-height {
      height: 100dvh;
      max-height: 100dvh;
    }
  }
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 222.2 47.4% 11.2%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 222.2 84% 4.9%;
    --radius: 0.5rem;
    /* Surface elevation system for light mode */
    --surface-1: 0 0% 98%; /* Page background */
    --surface-2: 0 0% 96%; /* Cards, panels */
    --surface-3: 0 0% 94%; /* Modals, tooltips */
    /* Semantic state colors for light mode */
    --success: 142 76% 36%; /* Green-600 equivalent with better contrast */
    --success-foreground: 355 20% 98%;
    --warning: 48 96% 53%; /* Yellow-500 equivalent */
    --warning-foreground: 20 14.3% 4.1%;
    --info: 212 97% 53%; /* Blue-500 equivalent */
    --info-foreground: 0 0% 98%;
  }

  .dark {
    /* Improved dark mode palette - less harsh, better contrast */
    --background: 224 71% 4%; /* #0f0f1a - softer than previous harsh background */
    --foreground: 213 31% 91%; /* #e2e8f0 - better readability */
    --card: 224 71% 6%; /* Slightly elevated from background */
    --card-foreground: 213 31% 91%;
    --popover: 224 71% 8%; /* More elevated for modals/dropdowns */
    --popover-foreground: 213 31% 91%;
    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 220 9% 65%; /* #94a3b8 - 4.6:1 contrast ratio (WCAG AA compliant) */
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 220 13% 20%; /* #333338 - better dark border */
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    /* Surface elevation system for dark mode - Material Design 3 inspired */
    --surface-1: 224 71% 6%; /* #151520 - Page background elevated */
    --surface-2: 224 71% 8%; /* #1a1a28 - Cards, panels elevated */
    --surface-3: 224 71% 10%; /* #1f1f34 - Modals, tooltips most elevated */
    /* Semantic state colors for dark mode */
    --success: 142 76% 36%; /* Consistent green for success states */
    --success-foreground: 355 20% 98%;
    --warning: 48 96% 53%; /* Consistent yellow for warning states */
    --warning-foreground: 20 14.3% 4.1%;
    --info: 212 97% 53%; /* Consistent blue for info states */
    --info-foreground: 0 0% 98%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

@layer utilities {
  /* Screen reader only content */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* Show content when focused (for skip links) */
  .sr-only.focus\:not-sr-only:focus,
  .focus\:not-sr-only:focus {
    position: static;
    width: auto;
    height: auto;
    padding: inherit;
    margin: inherit;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }

  /* High contrast focus indicators */
  .focus-visible\:ring-high-contrast:focus-visible {
    --tw-ring-color: #000;
    --tw-ring-offset-color: #fff;
  }

  @media (prefers-color-scheme: dark) {
    .focus-visible\:ring-high-contrast:focus-visible {
      --tw-ring-color: #fff;
      --tw-ring-offset-color: #000;
    }
  }

  /* Ensure minimum touch target sizes for mobile */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }

  /* Enhanced touch targets for mobile */
  .touch-target-enhanced {
    min-height: 48px;
    min-width: 48px;
  }

  @media (pointer: coarse) {
    /* Apply larger touch targets on touch devices */
    .touch-adaptive {
      min-height: 48px;
      min-width: 48px;
    }
  }

  /* Hide scrollbars while maintaining scrollability */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .border {
      border-width: 2px;
    }

    .focus-visible\:ring-2:focus-visible {
      --tw-ring-width: 3px;
    }

    /* Enhanced contrast for text */
    .text-muted-foreground {
      color: hsl(215 20% 35%);
    }

    /* Stronger borders in high contrast mode */
    .border-muted {
      border-color: hsl(215 20% 40%);
    }

    /* Enhanced button contrast */
    .bg-destructive {
      background-color: hsl(0 70% 45%);
    }
  }

  /* WCAG AA compliant color utilities */
  .text-contrast-aa {
    color: hsl(220 13% 18%); /* Contrast ratio 7:1 on white */
  }

  .text-contrast-subtle {
    color: hsl(220 9% 46%); /* Contrast ratio 4.5:1 on white - minimum AA */
  }

  .bg-contrast-subtle {
    background-color: hsl(220 13% 91%);
    color: hsl(220 13% 18%);
  }

  /* Error state with sufficient contrast */
  .text-error-aa {
    color: hsl(0 65% 45%); /* Contrast ratio 4.8:1 on white */
  }

  /* Success state with sufficient contrast */
  .text-success-aa {
    color: hsl(120 50% 35%); /* Contrast ratio 4.9:1 on white */
  }

  /* Warning state with sufficient contrast */
  .text-warning-aa {
    color: hsl(45 100% 35%); /* Contrast ratio 5.2:1 on white */
  }
}
