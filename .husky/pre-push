#!/bin/sh
. "$(dirname "$0")/common.sh"

echo "Running pre-push checks..."
echo ""

# TypeScript type check
echo "Running TypeScript type check..."
if ! pnpm run typecheck; then
  print_error "TypeScript errors found. Please fix them before pushing."
  echo ""
  echo "To bypass this check (emergency only): git push --no-verify"
  exit 1
fi

# ESLint
echo ""
echo "Running ESLint..."
if ! pnpm run lint; then
  print_error "ESLint errors found. Please fix them before pushing."
  echo ""
  echo "To bypass this check (emergency only): git push --no-verify"
  exit 1
fi

# Unit tests
echo ""
echo "Running unit tests..."
if ! pnpm run test; then
  print_error "Unit tests failed. Please fix them before pushing."
  echo ""
  echo "To bypass this check (emergency only): git push --no-verify"
  exit 1
fi

echo ""
print_success "All pre-push checks passed!"
